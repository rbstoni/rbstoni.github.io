@page "/new-post"
@using Rtrw.Client.Wasm.Components.Enums
@using Rtrw.Client.Wasm.Components.Extensions
@using Rtrw.Client.Wasm.Models
@using Rtrw.Client.Wasm.Services
@inject NavigationManager NavigationManager
@inject IModalService ModalService
@inject IWindowHistoryService HistoryService

<CascadingValue Value="@Post">
    <EditForm Model="Post">
        <div class="page-layout">
            <div class="page-header">
                <RtrwIconButton Href="/" OnClick="@(()=>HistoryService.Back())">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 17.59 31.18">
                        <path d="M4443.908-198.838,4431.146-211.6l12.762-12.762" transform="translate(-4429.146 227.19)" fill="none" stroke="#707070" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" />
                    </svg>
                </RtrwIconButton>
                <ChangePostCategory Category="@Post.Category" UpdatePostCategory="UpdatePostCategory"/>
                <RtrwButton Type=ButtonType.Button
                            Variant=Variant.Filled
                            Color=ThemeColor.Primary>
                    Post
                </RtrwButton>
            </div>

            @if (Post.Category == PostCategory.SuaraWarga)
            {
                <SuaraWarga />
            }
            @if (Post.Category == PostCategory.Liputan)
            {
                <Liputan />
            }
            @if (Post.Category == PostCategory.Pengumuman)
            {
                <Pengumuman />
            }
        </div>
    </EditForm>
</CascadingValue>

@code {
    [Parameter] public Post Post { get; set; } = new();
    void UpdatePostCategory(PostCategory category)
    {
        Post.Category = category;
    }
}